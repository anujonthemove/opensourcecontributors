<!DOCTYPE html>
<html lang="en" ng-app="ghca">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link rel="icon" href="/favicon.ico">

    <title>GitHub Contributions Archive</title>

    <link href="/static/css/bootstrap.min.css" rel="stylesheet">
    <link href="/static/css/bootstrap-theme.min.css" rel="stylesheet">
    <link href="/static/octicons/octicons.css" rel="stylesheet">
    <link href="/static/css/loader.css" rel="stylesheet">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
    <script src="/static/js/angular.min.js"></script>
    <script src="/static/js/bootstrap.min.js"></script>
    <script src="/static/js/ie10-viewport-bug-workaround.js"></script>
    <script src="/static/js/handlebars-v3.0.3.js"></script>
    <script src="/static/js/moment.min.js"></script>
    <style>
     body {
       margin-top:60px;
     }
     .query-container {
       padding:10px;
     }
    </style>

    <script type="text/javascript" src="/static/js/app.js"></script>

    <!-- Handlebars! -->
    <script id="results-summary-template" type="text/x-handlebars-template">
      <h4>
        <span class="mega-octicon octicon-person"></span>&nbsp;&nbsp;
        <a href="https://github.com/{{user}}"><strong>{{user}}</strong></a>
        made
        <strong>{{total}}</strong> contributions
        to
        <strong>{{repos.length}}</strong> repositories
      </h4>
    </script>
    <script id="gollumevent-template" type="text/x-handlebars-template">
      {{#ifMultiplePages this}}
      edited multiple Wiki pages:
      <ul>
      {{#each pages}}
        <li>
          {{action}} the page
          <a href="{{html_url}}">{{title}}</a>
          (<a href="{{html_url}}/_history">history</a>)
        </li>
      {{/each}}
      </ul>
      {{else}}
      {{#with pages.[0]}}
      {{action}} the Wiki page
      <a href="{{html_url}}">{{title}}</a>
      (<a href="{{html_url}}/_history">history</a>)
      {{/with}}
      {{/ifMultiplePages}}
    </script>
    <script id="issuesevent-template" type="text/x-handlebars-template">
      {{action}} issue
        <a href="https://github.com/{{repo}}/issues/{{issue_number}}">
          {{issue_number}}
        </a>
    </script>
    <script id="pushevent-template" type="text/x-handlebars-template">
      pushed {{distinct_commit_count}}
      {{pluralize distinct_commit_count "commit" "commits"}} to
        <a href="https://github.com/{{repo}}/commits/{{head}}">{{ref}} ({{formatSHA head}})</a>
    </script>
    <script id="commitcommentevent-template" type="text/x-handlebars-template">
      <a href="{{html_url}}">commented</a>
      on commit
      <a href="https://github.com/{{repo}}/commits/{{commit_id}}">{{formatSHA commit_id}}</a>
      {{path}}: <a href="{{html_url}}">{{truncate body}}</a>
    </script>
    <script id="releaseevent-template" type="text/x-handlebars-template">
      released tag
      <a href="https://github.com/{{repo}}/releases/tag/{{tag_name}}">{{tag_name}}</a>
    </script>
    <script id="publicevent-template" type="text/x-handlebars-template">
      open-sourced <a href="https://github.com/{{repo}}">{{repo}}</a>!
    </script>
    <script id="memberevent-template" type="text/x-handlebars-template">
        {{target_action}}
        <a href="https://github.com/{{target_user}}">{{target_user}}</a> to
        <a href="https://github.com/{{repo}}">{{repo}}</a>
    </script>
    <script id="issuecommentevent-template" type="text/x-handlebars-template">
      <a href="{{comment_url}}">commented</a>
      on
      <a href="{{issue_url}}">issue {{issue_number}}</a>
    </script>
    <script id="contributions-template" type="text/x-handlebars-template">
      {{#if events}}
      <nav>
        <ul class="pagination">
          {{#pagination currentPage pageCount 5}}

          {{#unless startFromFirstPage}}
          <li>
            <a href="#" aria-label="Previous"><span aria-hidden="true">&laquo;</span></a>
          </li>
          {{/unless}}

          {{#each pages}}
          {{#if isCurrent}}
          <li class="active">
            <a data-page="{{page}}" class="pagination-link" href="#">
              {{page}}
              <span class="sr-only">(current)</span>
            </a>
          </li>
          {{/if}}
          {{#unless isCurrent}}
          <li>
            <a data-page="{{page}}" class="pagination-link" href="#">{{page}}</a>
          </li>
          {{/unless}}
          {{/each}}

          {{#unless endAtLastPage}}
          <li>
            <a href="#" aria-label="Next"><span aria-hidden="true">&raquo;</span></a>
          </li>
          {{/unless}}

          {{/pagination}}
        </ul>
      </nav>


        <table class="table table-striped">
          <thead>
            <th>
              <!-- event type -->
            </th>
            <th>
              <span class="octicon octicon-calendar"></span>
            </th>
            <th>
              <span class="octicon octicon-repo"></span>
            </th>
            <th>
              <span class="octicon octicon-person"></span>
            </th>
            <th>
              <!-- description -->
            </th>
          </thead>
          <tbody>
            {{#each events}}
            <tr>
              <td>
                <span title="{{type}}" class="octicon {{eventIcon type}}"></span>
              </td>
              <td title="{{created_at}}">
                {{dateFmt created_at}}
              </td>
              <td style="white-space:nowrap">
                <a href="https://github.com/{{repo}}">{{repo}}</a>
              </td>
              <td>
                <a href="https://github.com/{{user}}">{{user}}</a>
              </td>
              <td>
                {{> (selectEventPartial this) }}
              </td>
            </tr>
            {{/each}}
          </tbody>
        </table>
        {{else}}
        <div class="alert alert-danger" role="alert">
          <span class="glyphicon glyphicon-exclamation-sign pull-right" aria-hidden="true"></span>
          <strong>No results for that user.</strong>
        </div>
        {{/if}}
    </script>

    <script>
     ///////////////////////
     // Handlebars things //
     ///////////////////////
     // Helpers
     Handlebars.registerHelper('pluralize', function(c, s, p) {
       return (c === 1) ? s : p;
     });
     Handlebars.registerHelper('truncate', function(s) {
       if (!s) { return ""; }
       return (s.length > 15) ? s.slice(0,15)+"..." : s;
     });
     Handlebars.registerHelper('dateFmt', function(d) {
       //return d ? moment(d).calendar() : "";
       return d ? moment(d).fromNow() : "";
     });
     Handlebars.registerHelper('ifMultiplePages', function(ctx, options) {
       return (ctx.pages.length > 1) ? options.fn(this) : options.inverse(this);
     });
     Handlebars.registerHelper("eventIcon", function(eventType) {
       var eventTypeData = {
         "GollumEvent"        : "book",
         "IssuesEvent"        : "issue-opened",
         "PushEvent"          : "repo-push",
         "CommitCommentEvent" : "comment",
         "ReleaseEvent"       : "tag",
         "PublicEvent"        : "megaphone",
         "MemberEvent"        : "person",
         "IssueCommentEvent"  : "comment-discussion"
       };
       var icon = eventTypeData[eventType];
       return "octicon-" + icon;
     });
     selectEventPartial = function(event) {
       return event["type"];
     }
     Handlebars.registerHelper("selectEventPartial", selectEventPartial);
     Handlebars.registerHelper("formatSHA", function(hash) {
       return hash.slice(0,7);
     });
     Handlebars.registerHelper('pagination', function(currentPage, totalPage, size, options) {
       var startPage, endPage, context;

       if (arguments.length === 3) {
         options = size;
         size = 5;
       }

       startPage = currentPage - Math.floor(size / 2);
       endPage = currentPage + Math.floor(size / 2);

       if (startPage <= 0) {
         endPage -= (startPage - 1);
         startPage = 1;
       }

       if (endPage > totalPage) {
         endPage = totalPage;
         if (endPage - size + 1 > 0) {
           startPage = endPage - size + 1;
         } else {
           startPage = 1;
         }
       }

       context = {
         startFromFirstPage: false,
         pages: [],
         endAtLastPage: false,
       };
       if (startPage === 1) {
         context.startFromFirstPage = true;
       }
       for (var i = startPage; i <= endPage; i++) {
         context.pages.push({
           page: i,
           isCurrent: i === currentPage,
         });
       }
       if (endPage === totalPage) {
         context.endAtLastPage = true;
       }

       return options.fn(context);
     });


     Handlebars.registerPartial("GollumEvent"        , $("#gollumevent-template").html());
     Handlebars.registerPartial("IssuesEvent"        , $("#issuesevent-template").html());
     Handlebars.registerPartial("PushEvent"          , $("#pushevent-template").html());
     Handlebars.registerPartial("CommitCommentEvent" , $("#commitcommentevent-template").html());
     Handlebars.registerPartial("ReleaseEvent"       , $("#releaseevent-template").html());
     Handlebars.registerPartial("PublicEvent"        , $("#publicevent-template").html());
     Handlebars.registerPartial("MemberEvent"        , $("#memberevent-template").html());
     Handlebars.registerPartial("IssueCommentEvent"  , $("#issuecommentevent-template").html());

     var renderTemplate = Handlebars.compile(
       $("#contributions-template").html()
     );
     var renderSummary = Handlebars.compile(
       $("#results-summary-template").html()
     );

     var _query = "";

     var runSearch = function(query, page) {
       _query = query;
       var url = "/search/"+query+"/"+page;
       $("#loader").show();
       $("#help").hide();
       $("#results").hide();
       $("#submit-button").attr("disabled","disabled");
       $.getJSON(url, function(data) {
         $("#results-table").html(
           renderTemplate(data)
         );
         $("#summary").html(
           renderSummary(data)
         );
         $("#results").show();
       }).always(function() {
         $("#loader").hide();
         $("#submit-button").removeAttr("disabled");
       });
     };

     $(function() {
       $("form#user-query").submit(function(e) {
         e.preventDefault();
         var query = $("#query").val();
         runSearch(query, 1);
       });
     });

     $(document).on("click", ".pagination-link", function(e) {
       runSearch(_query, $(this).data("page"));
     });
    </script>

    <!-- <link href="/static/css/theme.css" rel="stylesheet"> -->

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>

  <body role="document">

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="/">GitHub Contributions Archive</a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li class="active"><a href="#">Home</a></li>
            <li><a href="http://hut8.io">Hut8.io</a></li>
            <li><a href="mailto:liambowen@gmail.com">Contact</a></li>
          </ul>
          <form class="navbar-form navbar-right" id="user-query">
            <div class="form-group">
              <label for="query" class="sr-only">GitHub Username</label>
              <input type="text" class="form-control" id="query" placeholder="GitHub User">
            </div>
            <button id="submit-button" type="submit" class="btn btn-primary">Search</button>
          </form>
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container" role="main">
      <div class="well">
        <div id="help">
          <h3>Search for a user above to begin</h3>
        </div>
        <div id="summary">

        </div>
      </div>
        <div id="results" style="display:none" class="row">
          <div class="col-md-12">
            <div id="results-table">

            </div>
          </div>
        </div>

      <div id="loader" style="display:none;"   class="tetrominos">
        <div class="tetromino box1"></div>
        <div class="tetromino box2"></div>
        <div class="tetromino box3"></div>
        <div class="tetromino box4"></div>
      </div>
    </div> <!-- /container -->
<!--
-->

  </body>
</html>
